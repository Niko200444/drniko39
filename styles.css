:root {
  --bg: #f3f4f6;
  --bg-dark: #020617;
  --card-bg: #ffffff;
  --card-bg-dark: #0f172a;
  --text: #0f172a;
  --text-muted: #6b7280;
  --accent: #6366f1;
  --accent-soft: rgba(99, 102, 241, 0.15);
  --danger: #ef4444;
  --success: #10b981;
  --border: #e5e7eb;
  --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.08);
  --radius-lg: 18px;
  --radius-md: 12px;
  --radius-pill: 999px;
  --transition-fast: 0.18s ease-out;
  --transition: 0.25s cubic-bezier(0.4, 0, 0.2, 1);
}

*,
*::before,
*::after { box-sizing: border-box; }

html, body {
  margin: 0; padding: 0;
  font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: radial-gradient(circle at top left, #eef2ff 0, #f9fafb 45%, #e0f2fe 100%);
  color: var(--text);
  min-height: 100vh;
}

.hidden { display: none !important; }

/* ====== DARK MODE (mövcud hissələr) ====== */
body.dark-mode {
  background: radial-gradient(circle at top left, #020617 0, #020617 40%, #020617 100%);
  color: #e5e7eb;
}
body.dark-mode .welcome-card,
body.dark-mode .top-bar,
body.dark-mode .categories,
body.dark-mode .quiz-container,
body.dark-mode .question,
body.dark-mode .side-panel { background-color:#020617;color:#e5e7eb;box-shadow:0 18px 45px rgba(0,0,0,0.6);border-color:rgba(51,65,85,0.9);}
body.dark-mode .logo-sub{color:#9ca3af;}
body.dark-mode .section-title i{color:#a5b4fc;}
body.dark-mode .categories{border:1px solid rgba(51,65,85,0.9);}
body.dark-mode .category-btn{background:rgba(15,23,42,0.9);color:#e5e7eb;border-color:rgba(75,85,99,0.9);}
body.dark-mode .category-btn:hover{background:rgba(30,64,175,0.35);border-color:rgba(129,140,248,0.9);}
body.dark-mode .category-btn.selected{background:linear-gradient(135deg,#4f46e5,#22c55e);color:#f9fafb;border-color:transparent;box-shadow:0 18px 40px rgba(37,99,235,0.6);}
body.dark-mode .top-bar{background:rgba(15,23,42,0.98);border:1px solid rgba(31,41,55,0.9);}
body.dark-mode .top-control{background:rgba(17,24,39,0.95);color:#e5e7eb;}
body.dark-mode .top-control input, body.dark-mode .top-control select{color:#e5e7eb;}
body.dark-mode #searchContainer i{color:#9ca3af;}
body.dark-mode .quiz-container{background:radial-gradient(circle at top left,#020617 0,#020617 40%,#020617 100%);}
body.dark-mode .quiz-filter-btn{background:rgba(15,23,42,0.98);color:#e5e7eb;border-color:rgba(55,65,81,0.9);}
body.dark-mode .quiz-filter-btn.active{background:linear-gradient(135deg,#4f46e5,#22c55e);border-color:transparent;}
body.dark-mode .exam-bar{color:#e5e7eb;}
body.dark-mode .exam-status{color:#9ca3af;}
body.dark-mode .exam-summary{background:rgba(22,163,74,0.18);border-color:rgba(34,197,94,0.9);}
body.dark-mode .question{background:radial-gradient(circle at top left,#020617 0,#020617 40%,#020617 100%);border-color:rgba(51,65,85,0.9);}
body.dark-mode .question-number{color:#a5b4fc;}
body.dark-mode .question-meta{color:#9ca3af;}
body.dark-mode .answer-btn{background:rgba(15,23,42,0.98);border-color:rgba(75,85,99,0.95);color:#e5e7eb;}
body.dark-mode .answer-btn:hover{box-shadow:0 12px 26px rgba(15,23,42,0.9);border-color:rgba(129,140,248,0.95);}
body.dark-mode .answer-letter{background:rgba(75,85,99,0.8);color:#e5e7eb;}
body.dark-mode .answer-btn.correct{background:rgba(22,163,74,0.22);border-color:rgba(34,197,94,0.98);}
body.dark-mode .answer-btn.wrong{background:rgba(185,28,28,0.25);border-color:rgba(248,113,113,0.98);}
body.dark-mode .answer-btn.exam-selected{background:rgba(30,64,175,0.32);border-color:rgba(59,130,246,0.98);}
body.dark-mode .note-pill{color:#9ca3af;}
body.dark-mode .correct-answer-text{color:#4ade80;}
body.dark-mode .icon-btn{background:rgba(15,23,42,0.98);border-color:rgba(75,85,99,0.9);color:#e5e7eb;}
body.dark-mode .icon-btn:hover{background:rgba(30,64,175,0.35);}
body.dark-mode .icon-btn.flagged{border-color:rgba(250,204,21,0.95);background:rgba(250,204,21,0.16);}
body.dark-mode .icon-btn.admin-only{border-style:dashed;}
body.dark-mode .icon-btn.has-note{border-color:rgba(129,140,248,0.98);background:rgba(79,70,229,0.24);}
body.dark-mode .note-block{background:rgba(15,23,42,0.98);border-color:rgba(55,65,81,0.9);}
body.dark-mode .note-block textarea{background:#020617;color:#e5e7eb;border-color:rgba(75,85,99,0.95);}
body.dark-mode .note-save-btn{background:linear-gradient(135deg,#4f46e5,#22c55e);}
body.dark-mode .page-nav button{background:rgba(15,23,42,0.98);color:#e5e7eb;border-color:rgba(55,65,81,0.9);}
body.dark-mode .page-nav button.active{background:linear-gradient(135deg,#4f46e5,#22c55e);border-color:transparent;}
body.dark-mode .side-panel{background:rgba(15,23,42,0.98);border-color:rgba(31,41,55,0.9);}
body.dark-mode .side-section h3{color:#e5e7eb;}
body.dark-mode .stats-info span.label{color:#9ca3af;}
body.dark-mode .mini-list{background:rgba(15,23,42,0.98);border-color:rgba(55,65,81,0.9);color:#e5e7eb;}
body.dark-mode .mini-list.empty{color:#6b7280;}
body.dark-mode .mini-pill{background:rgba(30,64,175,0.5);color:#e5e7eb;}
body.dark-mode .mini-pill.edited{background:rgba(22,163,74,0.4);}
body.dark-mode .edited-item{background:rgba(22,163,74,0.2);border-color:rgba(34,197,94,0.9);}
body.dark-mode .edited-diff{color:#cbd5f5;}
body.dark-mode .side-toggle{background:rgba(15,23,42,0.98);color:#e5e7eb;box-shadow:0 12px 30px rgba(0,0,0,0.9);}
body.dark-mode .floating-dark-btn{background:linear-gradient(135deg,#facc15,#f97316);box-shadow:0 16px 32px rgba(248,250,109,0.3);}
body.dark-mode .floating-admin-btn{box-shadow:0 16px 32px rgba(34,197,94,0.4);}
body.dark-mode ::-webkit-scrollbar{width:8px;}
body.dark-mode ::-webkit-scrollbar-track{background:#020617;}
body.dark-mode ::-webkit-scrollbar-thumb{background:#4b5563;border-radius:999px;}
body.dark-mode ::-webkit-scrollbar-thumb:hover{background:#6b7280;}

/* Floating buttons */
.floating-dark-btn, .floating-admin-btn{
  position: fixed; left: 18px; z-index: 1001; padding: 10px 16px;
  border-radius: var(--radius-pill); border: none; cursor: pointer;
  font-size: 0.9rem; font-weight: 600; display: flex; align-items: center; gap: 8px; color: #fff;
  box-shadow: 0 14px 30px rgba(37, 99, 235, 0.3);
  background: linear-gradient(135deg, #6366f1, #8b5cf6);
  transition: transform var(--transition-fast), box-shadow var(--transition-fast), opacity var(--transition-fast);
}
.floating-dark-btn { top: 18px; }
.floating-admin-btn { top: 60px; }
.floating-dark-btn:hover, .floating-admin-btn:hover { transform: translateY(-2px); box-shadow: 0 18px 40px rgba(37,99,235,0.45); }
.floating-admin-btn.admin-on{ background: linear-gradient(135deg, #16a34a, #22c55e); }
.floating-mobile-btn {
  position: fixed;
  left: 18px;
  top: 100px; /* qaranlıq rejimdən bir az aşağıda */
  z-index: 1001;
  padding: 10px 16px;
  border-radius: var(--radius-pill);
  border: none;
  cursor: pointer;
  font-size: 0.9rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
  color: #fff;
  background: linear-gradient(135deg, #f59e42, #6366f1);
  box-shadow: 0 14px 30px rgba(99, 102, 241, 0.18);
  transition: transform var(--transition-fast), box-shadow var(--transition-fast), opacity var(--transition-fast);
}
.floating-mobile-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 18px 40px rgba(99,102,241,0.25);
}
/* Welcome */
.welcome-screen{ min-height: 100vh; display:flex; align-items:center; justify-content:center; padding:24px; }
.welcome-card{ max-width:420px; width:100%; background:rgba(255,255,255,0.96); border-radius:26px; padding:32px 28px 28px; box-shadow:0 22px 50px rgba(15,23,42,0.18); text-align:center; position:relative; overflow:hidden; }
.welcome-card::before{ content:""; position:absolute; inset:-40%; background: radial-gradient(circle at top left, rgba(129,140,248,0.2), transparent 60%), radial-gradient(circle at bottom right, rgba(45,212,191,0.2), transparent 55%); opacity:0.9; pointer-events:none; }
.welcome-card h1{ font-size:2.4rem; margin:0 0 8px; letter-spacing:0.08em; text-transform:uppercase; position:relative; z-index:1; }
.welcome-card p{ margin:0 0 24px; color:var(--text-muted); font-size:0.98rem; position:relative; z-index:1; }

/* Buttons */
.primary-btn, .secondary-btn{
  border-radius: var(--radius-pill); border:none; cursor:pointer; padding:10px 20px; font-size:0.95rem; font-weight:600;
  display:inline-flex; align-items:center; justify-content:center; gap:8px;
  transition: background var(--transition), color var(--transition), transform var(--transition-fast), box-shadow var(--transition-fast);
}
.primary-btn{ background: linear-gradient(135deg, #6366f1, #22c55e); color:#fff; box-shadow:0 16px 28px rgba(79,70,229,0.35); }
.primary-btn:hover{ transform: translateY(-1px); box-shadow:0 20px 40px rgba(79,70,229,0.45); }
.secondary-btn{ background: rgba(148,163,184,0.12); color:var(--text); }
.secondary-btn:hover{ background: rgba(148,163,184,0.2); }
.danger-link{ border:none; background:none; color:var(--danger); font-size:0.85rem; cursor:pointer; padding:6px 0; display:inline-flex; align-items:center; gap:6px; opacity:0.85;}
.danger-link:hover{ opacity:1; }

/* Main layout */
.main-content{ padding:16px 18px 24px; }
.top-bar{ display:flex; align-items:center; justify-content:space-between; gap:16px; padding:12px 16px; margin-bottom:14px; border-radius:18px; background:rgba(255,255,255,0.96); box-shadow:var(--shadow-soft);}
.logo{ display:flex; flex-direction:column;}
.logo-main{ font-weight:800; font-size:1.2rem; letter-spacing:0.06em;}
.logo-sub{ font-size:0.78rem; color:var(--text-muted);}
.top-actions{ display:flex; align-items:center; gap:12px;}
.top-control{ display:inline-flex; align-items:center; gap:6px; background:rgba(248,250,252,0.9); border-radius:var(--radius-pill); padding:6px 10px; font-size:0.85rem;}
.top-control select, .top-control input{ border:none; outline:none; font-size:0.85rem; background:transparent;}
#searchContainer{ padding-left:12px;}
#searchContainer i{ color:var(--text-muted);}
.tiny-stats span{ font-weight:600;}

.layout{ display:grid; grid-template-columns:230px minmax(0,1fr) 260px; gap:18px; margin-top:12px; }

/* Categories */
.categories{ background:rgba(255,255,255,0.96); border-radius:22px; padding:16px 14px 14px; box-shadow:var(--shadow-soft);}
.section-title{ font-size:0.98rem; margin:0 0 12px; display:flex; align-items:center; gap:8px;}
.section-title i{ color:var(--accent);}
.category-list{ display:flex; flex-direction:column; gap:6px; margin-bottom:16px;}
.category-btn{ width:100%; border-radius:999px; border:1px solid rgba(148,163,184,0.4); padding:8px 10px; background:rgba(248,250,252,0.9); display:flex; align-items:center; gap:8px; font-size:0.86rem; cursor:pointer; transition: background var(--transition-fast), transform var(--transition-fast), box-shadow var(--transition-fast), border-color var(--transition-fast);}
.category-btn i{ width:18px; text-align:center;}
.category-btn.selected{ background:linear-gradient(135deg,#6366f1,#22c55e); color:#fff; border-color:transparent; box-shadow:0 14px 30px rgba(79,70,229,0.35); transform:translateY(-1px);}
.reset-block{ padding-top:8px; border-top:1px dashed rgba(148,163,184,0.7); display:flex; flex-direction:column; gap:4px; }

/* Quiz area */
.quiz-area{ min-width:0; }
.exam-bar{ display:flex; justify-content:space-between; align-items:center; margin-bottom:6px; font-size:0.8rem; }
.exam-status{ color:var(--text-muted); }
.exam-controls-inline{ display:inline-flex; align-items:center; gap:6px; }
.exam-timer{ font-weight:600; }
.exam-btn{ border-radius:999px; border:none; padding:4px 10px; font-size:0.78rem; cursor:pointer; background:var(--accent); color:#fff; display:inline-flex; align-items:center; gap:4px; }
.exam-btn.secondary{ background:rgba(148,163,184,0.9); }
.exam-summary{ margin-bottom:8px; padding:6px 10px; border-radius:10px; background:rgba(34,197,94,0.08); border:1px solid rgba(34,197,94,0.4); font-size:0.78rem; }

.mobile-mode-toggle{ font-size:0.78rem; margin-bottom:8px; color:var(--text-muted); }
.mobile-mode-toggle label{ display:inline-flex; align-items:center; gap:6px; }

/* Flashcard üst nəzarətlər */
.flashcard-controls{
  display:flex; align-items:center; justify-content:space-between; gap:8px;
  padding:8px 10px; margin-bottom:10px; border-radius:12px; background:rgba(248,250,252,0.96);
  border:1px solid rgba(148,163,184,0.5);
}
.sequence-mode label{ margin-right:10px; font-size:0.85rem; }
.flash-nav{ display:flex; align-items:center; gap:8px; }
.card-counter{ font-weight:700; min-width:60px; text-align:center; }

.quiz-filters{ display:inline-flex; flex-wrap:wrap; gap:6px; margin-bottom:10px; }
.quiz-filter-btn{ border-radius:999px; border:1px solid rgba(148,163,184,0.7); background:rgba(248,250,252,0.96); padding:4px 10px; font-size:0.8rem; cursor:pointer; }
.quiz-filter-btn.active{ background:var(--accent); color:#fff; border-color:transparent; }

.quiz-container{ background:rgba(255,255,255,0.96); border-radius:22px; padding:16px 18px 10px; box-shadow:var(--shadow-soft); min-height:280px; }
.empty-hint{ text-align:center; padding:30px 10px; color:var(--text-muted); }
.empty-hint .emoji{ font-size:2.6rem; margin-bottom:8px; }

.question{
  border-radius:18px; padding:14px 16px 10px; margin-bottom:14px;
  background: linear-gradient(135deg, rgba(99,102,241,0.08), rgba(248,250,252,0.95));
  border:1px solid rgba(148,163,184,0.4); position:relative;
}
.question-header{ display:flex; align-items:flex-start; justify-content:space-between; gap:8px; }
.question h2{ margin:0 0 4px; font-size:1rem; }
.question-number{ font-weight:700; font-size:0.95rem; color:var(--accent); margin-right:6px; }
.question-meta{ display:inline-flex; gap:6px; font-size:0.75rem; color:var(--text-muted); }

/* Cavablar – alt-alta */
.answers{ margin-top:8px; display:flex; flex-direction:column; gap:8px; }
.answer-btn{
  border-radius:999px; border:1px solid rgba(148,163,184,0.5); background:rgba(248,250,252,0.9);
  padding:7px 12px; font-size:0.86rem; cursor:pointer; text-align:left; display:flex; align-items:center; gap:8px;
  transition: background var(--transition-fast), transform var(--transition-fast), box-shadow var(--transition-fast), border-color var(--transition-fast);
}
.answer-letter{ display:inline-flex; align-items:center; justify-content:center; width:20px; height:20px; border-radius:999px; background:rgba(148,163,184,0.18); font-size:0.75rem; flex-shrink:0; }
.answer-btn:hover{ transform:translateY(-1px); box-shadow:0 12px 20px rgba(148,163,184,0.3); border-color:rgba(99,102,241,0.7); }
.answer-btn.correct{ border-color:rgba(16,185,129,0.75); background:rgba(16,185,129,0.08); }
.answer-btn.wrong{ border-color:rgba(239,68,68,0.85); background:rgba(239,68,68,0.06); }
.answer-btn.exam-selected{ border-color:rgba(59,130,246,0.8); background:rgba(59,130,246,0.08); }

/* Question footer */
.question-footer{ display:flex; flex-wrap:wrap; align-items:center; gap:6px; margin-top:8px; justify-content:space-between; font-size:0.8rem; }
.question-actions{ display:inline-flex; flex-wrap:wrap; gap:6px; }
.icon-btn{ border-radius:999px; border:1px solid rgba(148,163,184,0.5); background:rgba(248,250,252,0.9); padding:4px 10px; font-size:0.78rem; cursor:pointer; display:inline-flex; align-items:center; gap:5px; transition: background var(--transition-fast), border-color var(--transition-fast), transform var(--transition-fast); }
.icon-btn:hover{ background:rgba(148,163,184,0.12); transform:translateY(-1px); }
.icon-btn.flagged{ border-color:rgba(250,204,21,0.9); background:rgba(250,204,21,0.08); }
.icon-btn.admin-only{ border-style:dashed; }
.icon-btn.has-note{ border-color:var(--accent); background:var(--accent-soft); }

.correct-answer-text{ font-size:0.8rem; color:var(--success); display:none; margin-top:2px; }
.correct-answer-text.visible{ display:block; }
.note-pill{ font-size:0.78rem; color:var(--text-muted); }

/* Qeyd bloku */
.note-block{ margin-top:6px; padding:6px 8px; border-radius:10px; background:rgba(248,250,252,0.9); border:1px dashed rgba(148,163,184,0.7); display:none; }
.note-block.open{ display:block; }
.note-block textarea{ width:100%; resize:vertical; min-height:50px; font-size:0.78rem; font-family:inherit; border-radius:8px; border:1px solid rgba(148,163,184,0.7); padding:4px 6px; }
.note-save-btn{ margin-top:4px; border-radius:999px; border:none; padding:3px 10px; font-size:0.75rem; cursor:pointer; background:var(--accent); color:#fff; }

/* Page navigation */
.page-nav{ margin-top:10px; display:flex; justify-content:center; gap:6px; flex-wrap:wrap; }
.page-nav button{ border-radius:999px; border:1px solid rgba(148,163,184,0.6); background:rgba(248,250,252,0.96); padding:4px 10px; font-size:0.8rem; cursor:pointer; }
.page-nav button.active{ background:var(--accent); color:#fff; border-color:transparent; }

/* Side panel */
.side-panel{ background:rgba(255,255,255,0.96); border-radius:22px; padding:14px 14px 18px; box-shadow:var(--shadow-soft); border:1px solid rgba(148,163,184,0.4); position:relative;}
.side-panel-header h2{ margin:0 0 8px; font-size:0.98rem;}
.side-section{ margin-top:8px;}
.side-section h3{ margin:8px 0 4px; font-size:0.86rem;}
.side-help{ font-size:0.76rem; color:var(--text-muted); margin-top:0;}
.stats-info{ font-size:0.8rem; display:grid; grid-template-columns:1fr 1fr; gap:4px 10px;}
.stats-info span.label{ color:var(--text-muted);}
.stats-info span.value{ font-weight:600;}
.mini-list{ max-height:120px; overflow-y:auto; border-radius:12px; border:1px dashed rgba(148,163,184,0.6); padding:4px 6px; font-size:0.78rem;}
.mini-list.empty{ border-style:dotted; text-align:center; color:var(--text-muted); padding:10px 4px; }
.mini-pill{ display:inline-flex; align-items:center; gap:4px; padding:3px 8px; border-radius:999px; background:rgba(148,163,184,0.2); margin:2px; cursor:pointer; border:none; font-size:0.75rem; }
.mini-pill.edited{ background:rgba(16,185,129,0.12);}
.edited-item{ border-radius:10px; padding:6px 7px; margin:3px 0; background:rgba(16,185,129,0.08); border:1px solid rgba(16,185,129,0.35);}
.edited-header{ display:flex; justify-content:space-between; gap:4px; font-size:0.78rem;}
.edited-diff{ font-size:0.75rem; color:var(--text-muted); margin-top:2px;}
.edited-switch-btn{ border-radius:999px; border:none; padding:3px 8px; font-size:0.72rem; cursor:pointer; background:var(--accent); color:#fff; }

/* Side toggle */
.side-toggle{ position:absolute; right:270px; top:50%; transform:translateY(-50%); border-radius:999px; border:none; padding:6px 8px; background:rgba(15,23,42,0.85); color:#fff; cursor:pointer; box-shadow:0 12px 30px rgba(15,23,42,0.5); z-index:10; }
body.side-collapsed .side-panel{ display:none; }
body.side-collapsed .layout{ grid-template-columns:230px minmax(0,1fr); }
body.side-collapsed .side-toggle{ right:20px; }
body.side-collapsed .side-toggle i{ transform:rotate(180deg); }

/* ====== FLASHCARD TAM EKRAN REJİMİ ====== */
body.flashcard-mode .top-bar,
body.flashcard-mode .categories,
body.flashcard-mode .side-panel,
body.flashcard-mode .quiz-filters,
body.flashcard-mode #pageNavigation { display: none !important; }

body.flashcard-mode .layout{ grid-template-columns: minmax(0, 1fr); }
body.flashcard-mode .quiz-container{
  min-height: calc(100vh - 90px);
  display:flex; align-items:center; justify-content:center;
  padding: 12px;
}
body.flashcard-mode .question{
  width: 100%; max-width: 760px;
  min-height: 60vh;
  display:flex; flex-direction:column;
  justify-content: center;
  margin: 0;
}
.swipe-hint{
  position:absolute; left:0; right:0; bottom:10px; text-align:center;
  font-size:0.78rem; color:var(--text-muted);
}

/* RESPONSIVE */
@media (max-width: 1024px) {
  .layout{ grid-template-columns:minmax(0,1fr); }
  .categories{ order:2; }
  .side-panel{ order:3; }
  .quiz-area{ order:1; }
  .side-toggle{ display:none; }
}
@media (max-width: 640px) {
  .top-bar{ flex-direction:column; align-items:flex-start; }
  .top-actions{ flex-wrap:wrap; justify-content:flex-start; }
}
